import React, { useState } from 'react';
import Sidebar from './components/Sidebar';
import Header from './components/Header';
import Dashboard from './components/Dashboard';
import ProfileForm from './components/Profileform';
import ProfileList from './components/ProfileList';
import PrintableReport from './components/PrintableReport';
import { INITIAL_FORM_STATE } from './data/Formconstants';

export default function SKYouthProfilingSystem() {
  const [view, setView] = useState('dashboard');
  const [profiles, setProfiles] = useState([]);
  const [sidebarOpen, setSidebarOpen] = useState(true);
  const [formData, setFormData] = useState(INITIAL_FORM_STATE);

  // ... (keep existing handlers like handleInputChange, etc.) ...
  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  const handleCheckboxChange = (value) => {
    setFormData(prev => ({
      ...prev,
      youthClassification: prev.youthClassification.includes(value)
        ? prev.youthClassification.filter(item => item !== value)
        : [...prev.youthClassification, value]
    }));
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    const newProfile = {
      ...formData,
      id: Date.now(),
      respondentNumber: profiles.length + 1,
      dateCreated: new Date().toLocaleDateString()
    };
    setProfiles(prev => [...prev, newProfile]);
    setFormData(INITIAL_FORM_STATE);
    alert('Youth profile saved successfully!');
    setView('list');
  };

  return (
    // UPDATED: Added 'print:h-auto print:overflow-visible'
    <div className="flex flex-col h-screen bg-[#E7F0FA] overflow-hidden print:h-auto print:overflow-visible">
      
      <Header 
        view={view} 
        profileCount={profiles.length} 
        sidebarOpen={sidebarOpen}
        setSidebarOpen={setSidebarOpen}
      />

      {/* UPDATED: Added 'print:overflow-visible' */}
      <div className="flex flex-1 overflow-hidden print:overflow-visible print:h-auto">
        
        <Sidebar 
          view={view}
          setView={setView}
          sidebarOpen={sidebarOpen}
          profileCount={profiles.length}
        />

        {/* UPDATED: Added 'print:overflow-visible print:h-auto' to allow full scrolling content to print */}
        <main className="flex-1 overflow-y-auto min-w-0 print:overflow-visible print:h-auto">
          
          <div className={view === 'report' ? 'p-8 bg-gray-500/10 min-h-full print:p-0 print:bg-white' : 'max-w-7xl mx-auto px-6 py-8'}>
            
            {view === 'dashboard' && <Dashboard profiles={profiles} setView={setView} />}
            
            {view === 'form' && (
              <ProfileForm 
                formData={formData}
                handleInputChange={handleInputChange}
                handleCheckboxChange={handleCheckboxChange}
                handleSubmit={handleSubmit}
              />
            )}

            {view === 'list' && <ProfileList profiles={profiles} setView={setView} />}

            {view === 'report' && <PrintableReport profiles={profiles} />}

          </div>
        </main>
      </div>
    </div>
  );
}